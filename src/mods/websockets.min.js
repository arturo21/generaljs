ws=function(){var numsockets;var socketUnt;var workerName;var retobject;var objectfinal;var socketi;var sockets;sockets=[];retobject={};objectfinal={};function printonerror(event){console.log("ERROR...");console.log(event.error)}function printonopen(event){console.log("Conexion abierta...")}function printonmsg(event){console.log("Enviando mensaje...");console.log(event.data)}return{set:function(nombreid,urldir){console.log("************************************SOCKET*******************************");console.log(socketUnt);console.log("************************************SOCKET*******************************");if(socketUnt==undefined){if(urldir!=""){try{socketUnt=new WebSocket(urldir)}catch(e){console.error(e)}finally{socketUnt.addEventListener("error",printonerror);socketUnt.addEventListener("open",printonopen);socketUnt.addEventListener("message",printonmsg);sockets[numsockets]={nombre:nombreid,inst:socketUnt};numsockets++}}}else{g.log("El WebSocket API no est√° soportado por el navegador.")}},get:function(nombreid){for(w in sockets){if(sockets[w].inst!=undefined){if(sockets[w].nombre==nombreid){g.log(sockets[w]);retobject.socket=sockets[w].inst;retobject.id=sockets[w].nombre;break}}}return retobject},close:function(nombreid){for(w in sockets){if(sockets[w].inst!=undefined){if(sockets[w].nombre==nombreid){socketi=sockets[w].inst;break}}}socketi.close();return 0},reply:function(nombreid,message,callbackmsg){var w=g.ws.get(nombreid);w.socket.addEventListener("message",callbackmsg);callbackmsg()},send:function(nombreid,message){var w=g.ws.get(nombreid);w.socket.send(message);g.log("************SOCKET RESPONSE*************");g.log(message);g.log("************SOCKET RESPONSE*************")}}}();module.exports=ws;