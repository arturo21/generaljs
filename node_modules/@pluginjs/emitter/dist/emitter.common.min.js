/*!
 * @pluginjs/emitter v0.7.15 (https://pluginjs.com)
 * Copyright 2019 Creation Studio Limited
 * Released under the GPL-3.0 License.
 */
"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var SimpleEmitter=_interopDefault(require("@pluginjs/simple-emitter"));class Emitter extends SimpleEmitter{constructor(){super(),this.namespaces={}}addListener(e,s){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.ensureListener(s);var{eventName:r,namespace:a}=this.constructor.parseEvent(e);if(!r)throw new Error("Event should not be null.");return this.listeners[r]||(this.listeners[r]={}),a?(this.addToEventWithNamespace(r,a,t,s,n),this.addToNamespace(r,a)):this.addToEvent(r,t,s,n),this}removeListener(e,s){if(this.hasListeners(e)){var{eventName:t,namespace:n}=this.constructor.parseEvent(e);switch(!0){case Boolean(!n&&t):this.filterListeners(t,"*",s);break;case Boolean(!t&&n):for(var r=this.namespaces[n],a=0;a<r.length;a++)this.filterListeners(r[a],n,s);for(var i=0;i<r.length;i++)Object.prototype.hasOwnProperty.call(this.listeners[r[i]],n)||this.removeEventInNamespaces(r[i],n);break;case Boolean(t&&n):var h=this.removeEventInNamespaces(t,n);this.filterListeners(t,n,s,h)}}return this}removeAllListeners(e){if(this.hasListeners(e)){var{eventName:s,namespace:t}=this.constructor.parseEvent(e);switch(!0){case Boolean(!t&&s):Object.keys(this.listeners[s]).forEach(e=>{Object.prototype.hasOwnProperty.call(this.namespaces,e)&&this.removeEventInNamespaces(s,e)}),delete this.listeners[s];break;case Boolean(!s&&t):for(var n=this.namespaces[t],r=0;r<n.length;r++)delete this.listeners[n[r]][t];delete this.namespaces[t];break;case Boolean(s&&t):this.removeEventInNamespaces(s,t),delete this.listeners[s][t]}}return this}hasListeners(e){var{eventName:s,namespace:t}=this.constructor.parseEvent(e);return!t&&s?!(!this.listeners[s]||0===Object.keys(this.listeners[s]).length):!s&&t?!(!this.namespaces[t]||0===Object.keys(this.namespaces[t]).length):!(!s||!t)&&!(!this.listeners[s]||!this.listeners[s][t]||0===this.listeners[s][t].length)}getListeners(e){if(this.hasListeners(e)){var{eventName:s,namespace:t}=this.constructor.parseEvent(e),n=[];switch(!0){case Boolean(!t&&s):return Object.keys(this.listeners[s]).forEach(e=>{for(var t=0;t<this.listeners[s][e].length;t++)n=n.concat(this.listeners[s][e][t])}),n;case Boolean(!s&&t):for(var r=this.namespaces[t],a=0;a<r.length;a++)for(var i=0;i<this.listeners[r[a]][t].length;i++)n=n.concat(this.listeners[r[a]][t][i]);return n;case Boolean(s&&t):var h=this.listeners[s];if(Object.prototype.hasOwnProperty.call(h,t)){for(var l=0;l<h[t].length;l++)n=n.concat(h[t][l]);return n}return n}}return[]}filterListeners(e,s,t,n){var r=this.listeners[e];void 0!==r[s]&&(r[s]=r[s].filter(e=>e.listener!==t),0===r[s].length&&(n&&n(),delete r[s])),this.listeners[e]=r}removeEventInNamespaces(e,s){for(var t=this.namespaces[s].length;t--;)this.namespaces[s][t]===e&&this.namespaces[s].splice(t,1)}addToEvent(e,s,t){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.listeners[e]["*"]||(this.listeners[e]["*"]=[]),this.listeners[e]["*"].push({context:s,listener:t,one:n})}addToEventWithNamespace(e,s,t,n){var r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.listeners[e][s]||(this.listeners[e][s]=[]),this.listeners[e][s].push({context:t,listener:n,one:r})}addToNamespace(e,s){this.namespaces[s]||(this.namespaces[s]=[]),this.checkNamespace(e,s)||this.namespaces[s].push(e)}checkNamespace(e,s){for(var t=0;t<this.namespaces[s].length;t++)if(this.namespaces[s][t]===e)return!0;return!1}static parseEvent(e){if("string"!=typeof e&&(e=e.toString()),-1===e.indexOf(".")){return{eventName:e.trim().length>1?e:null,namespace:null}}var s=e.split(".");return{eventName:0===s[0].trim().length?null:s[0],namespace:0===s[1].trim().length?null:s[1]}}}module.exports=Emitter;
